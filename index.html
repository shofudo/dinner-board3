<!doctype html>
<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>å¤•é£Ÿé€²è¡Œãƒœãƒ¼ãƒ‰ï¼ˆãƒŸãƒ‹ï¼‰</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <!-- ğŸ”§ SW & Cache killer (ä¸€æ™‚çš„) -->
<script>
(function() {
  // æ—¢å­˜ã® Service Worker ã‚’å…¨è§£é™¤
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations()
      .then(regs => regs.forEach(reg => reg.unregister()))
      .catch(()=>{});
  }
  // Cache Storage ã‚‚å…¨å‰Šé™¤
  if (window.caches && caches.keys) {
    caches.keys().then(keys => keys.forEach(k => caches.delete(k)));
  }
})();
</script>

  <body>
    <script>
  (function () {
    // â€œstay=1â€ ãŒä»˜ã„ã¦ã„ãªã„é€šå¸¸ã‚¢ã‚¯ã‚»ã‚¹ã¯ order.html ã«å¯„ã›ã‚‹
    if (!new URL(location.href).searchParams.get('stay')) {
      location.replace('./order.html?v=sync12&nocache=' + Date.now());
    }
  })();
</script>
    <!-- â–¼ å…¨ã¦æ¨ªä¸€åˆ—ã«ãŠã—ã‚ƒã‚Œã«é…ç½® -->
    <div style="display:flex;align-items:center;gap:20px;padding:16px 0;border-bottom:2px solid #e0e0e0;margin-bottom:16px;">
      <!-- è¨­å®šãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ï¼ˆå°ã•ã„ãƒœã‚¿ãƒ³ï¼‰ -->
      <a href="./settings.html" style="display:inline-flex;align-items:center;padding:8px 14px;border:1px solid #ccc;border-radius:8px;text-decoration:none;font-size:13px;color:#666;background:#fff;transition:all 0.2s;white-space:nowrap;">
        âš™ï¸ æœ¬æ—¥ã®è¨­å®š
      </a>
      
      <!-- ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆãŠã—ã‚ƒã‚Œã«ï¼‰ -->
      <h1 style="margin:0;font-size:24px;font-weight:700;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;flex-shrink:0;">
        ğŸ½ï¸ å¤•é£Ÿé€²è¡Œãƒœãƒ¼ãƒ‰
      </h1>
      
      <!-- ã‚¿ãƒ– -->
      <nav class="tabs" style="margin:0;">
        <button id="tab-input" aria-selected="true">ã‚ªãƒ¼ãƒ€ãƒ¼å…¥åŠ›</button>
        <button id="tab-kitchen">ã‚­ãƒƒãƒãƒ³è¡¨ç¤º</button>
      </nav>
      
      <!-- æœ¬æ—¥ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ãƒœã‚¿ãƒ³ï¼ˆå³ç«¯ã«é…ç½®ï¼‰ -->
      <button id="btn-reset-today" style="margin-left:auto;padding:8px 14px;border:1px solid #f44336;border-radius:8px;background:#fff;color:#f44336;font-size:13px;cursor:pointer;transition:all 0.2s;white-space:nowrap;">
        æœ¬æ—¥ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–
      </button>
    </div>

    <!-- å…¥åŠ›ç”»é¢ï¼šã“ã“ã«é€²è¡Œãƒœãƒ¼ãƒ‰ã‚’å‡ºã™ -->
    <section id="view-input" class="view is-active">

      <!-- ã“ã“ãŒè¦‹ãˆã¦ã„ã‚‹ï¼ˆè¦‹å‡ºã—ã®ã™ãä¸‹ï¼‰ -->
      <div id="boards"><!-- JSã§18:00/18:30/19:00ã‚’æç”» --></div>
      <!-- ã“ã“ã¾ã§ -->

    </section>

    <!-- ã‚­ãƒƒãƒãƒ³å´(æ–™ç†ã®é›†è¨ˆè¡¨ç¤º) -->
    <section id="view-kitchen" class="view">
      <h1 style="font-size:28px;margin-bottom:20px;text-align:center;">ğŸ³ ã‚­ãƒƒãƒãƒ³è¡¨ç¤º</h1>
      <div id="kitchen-display">
        <!-- ã“ã“ã«æ–™ç†ã®é›†è¨ˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ -->
      </div>
    </section>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getDatabase, ref, onValue, set, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

const firebaseConfig = {
  apiKey: "AIzaSyBArbWHqcazV8QGBHynPHQgqYyiAQn5mhw",
  authDomain: "dinner-management-d3580.firebaseapp.com",
  databaseURL: "https://dinner-management-d3580-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "dinner-management-d3580",
  storageBucket: "dinner-management-d3580.firebasestorage.app",
  messagingSenderId: "859809463635",
  appId: "1:859809463635:web:f276930f7dc721a02ff5a6"
};

const app = initializeApp(firebaseConfig);
const db  = getDatabase(app);

window.__db = { db, ref, onValue, set, serverTimestamp };
console.log('FirebaseåˆæœŸåŒ–OK(index)');
// Realtime è³¼èª­ï¼ˆã“ã‚ŒãŒç„¡ã„ã¨ä»–ç«¯æœ«ã®å¤‰åŒ–ãŒå±Šã‹ãªã„ï¼‰
const boardRef = ref(db, 'dinner-board-v3');
onValue(boardRef, (snap) => {
  const state = snap.val() || {};
  if (window.renderBoardV3) window.renderBoardV3(state);
});

</script>

<script src="app.js?v=sync13"></script>
